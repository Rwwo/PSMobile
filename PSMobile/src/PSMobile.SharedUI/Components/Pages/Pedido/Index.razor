@page "/pedidos"
@inherits IndexPedidosPage

<PageTitle>Pedidos</PageTitle>

<MudContainer Class="mt-4">
    @* <MudText Typo="Typo.h4" Class="mb-4">Cadastros</MudText> *@

    <!-- Botão de Voltar -->
    <BackButton Href="/"
                Text="Voltar" />

    <!-- Botão de Adicionar Cliente - Sempre Habilitado -->
    <AddButton Href="/pedidos/gravar"
               Text="Novo Pedido" />

    <MudGrid>
        <MudItem xs="12">
            <MudDataGrid @ref="dataGrid"
                         T="Pedidos"
                         ServerData="ServerReload"
                         Striped="IsStriped"
                         Hover="IsHover"
                         Dense="IsDense"
                         Bordered="IsBordered"
                         Filterable="false">

                <ToolBarContent>
                    <MudText Typo="Typo.h6">Pedidos</MudText>
                    <MudSpacer />
                    <MudTextField T="string" ValueChanged="@(s=>OnSearch(s))" Placeholder="Pesquise pelo número OU nome do Cliente" Adornment="Adornment.Start"
                                  AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
                </ToolBarContent>

                <Columns>

                    <TemplateColumn Title="Status">
                        <CellTemplate>
                            @if (context.Item.IsFatured)
                            {
                                <MudTooltip Text="Faturado">
                                    <MudIcon Icon="@Icons.Material.TwoTone.DoneAll" Color="Color.Success" />
                                </MudTooltip>
                            }
                            else if (context.Item.IsFinished)
                            {
                                <MudTooltip Text="Finalizado">
                                    <MudIcon Icon="@Icons.Material.Filled.Check" Color="Color.Warning" />
                                </MudTooltip>
                            }
                            else if (context.Item.IsOpen)
                            {
                                <MudTooltip Text="Aberto">
                                    <MudIcon Icon="@Icons.Material.Filled.DoneOutline" Color="Color.Info" />
                                </MudTooltip>
                            }
                            else if (context.Item.IsDeleted)
                            {
                                <MudTooltip Text="Deletado">
                                    <MudIcon Icon="@Icons.Material.TwoTone.Clear" Color="Color.Warning" />
                                </MudTooltip>
                            }

                        </CellTemplate>
                    </TemplateColumn>

                    <PropertyColumn Property="x => x.ped_numero" Title="Número" />
                    <PropertyColumn Property="x => x.ped_data" Title="Data" Format="dd/MM/yyyy" />
                    <PropertyColumn Property="x => x.ped_nome" Title="Cliente" />
                    <PropertyColumn Property="x => x.ped_total" Title="Total" Format="C2" />
                    <TemplateColumn>
                        <CellTemplate>
                            <MudStack Row Class="gap-2">
                                <EditButton Disabled="false" OnClick="@(() => GoToUpdate(context.Item))" />
                            </MudStack>
                        </CellTemplate>
                    </TemplateColumn>
                </Columns>
                <PagerContent>
                    <MudDataGridPager PageSizeOptions="@PageSizeOptionsString"
                                      RowsPerPageString="@RowsPerPageString"
                                      InfoFormat="@InfoFormatString"
                                      T="Pedidos" />
                </PagerContent>
            </MudDataGrid>
            <MudTooltip Text="Faturado">
                <MudIcon Icon="@Icons.Material.TwoTone.DoneAll" Color="Color.Success" /> Faturado
            </MudTooltip>
            <MudTooltip Text="Finalizado">
                <MudIcon Icon="@Icons.Material.Filled.Check" Color="Color.Warning" /> Finalizado
            </MudTooltip>
            <MudTooltip Text="Aberto">
                <MudIcon Icon="@Icons.Material.Filled.DoneOutline" Color="Color.Info" /> Aberto
            </MudTooltip>
            <MudTooltip Text="Deletado">
                <MudIcon Icon="@Icons.Material.TwoTone.Clear" Color="Color.Warning" /> Deletado
            </MudTooltip>
        </MudItem>
    </MudGrid>

</MudContainer>